#INFO: **** input file is /home/wsr/dftpart/test_hfeda/test_new.py ****
from dftpart import scfeda

ok = ['FAIL','OK']
mollist = [
#'c12h26',
'c2h6',
'c4h10','c6h14',
'c8h18','c12h26',
'c10h22'
]
basislist = [
#'6-31g',
'6-31gss','6-311gss','6-311+gss',
#"6311g(2df,2pd)"
'cc-pvdz','cc-pvtz',
'def2-svp','def2-tzvp'
]
with open("CH3_new.txt",'a') as f:
    for basis in basislist:
        for mol in mollist:
            test1 = scfeda.EDA()
            test1.gjf = './'+mol+'.xyz'
            test1.method = ['m062x',basis]
            test1.output = mol.upper()+'_'+basis+'_new'
            #test1.build()
            atme, tote, conv = test1.kernel()
            CH3E = atme[:4].sum()
            f.write("%s %.10f  %s\n" % (test1.output,CH3E,ok[conv]))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='lw06', release='3.10.0-957.el7.x86_64', version='#1 SMP Thu Nov 8 23:39:32 UTC 2018', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.3 (default, Mar 27 2019, 22:11:17) 
[GCC 7.3.0]
numpy 1.16.2  scipy 1.2.1
Date: Sun Jul 21 06:42:28 2019
PySCF version 1.6.2
PySCF path  /home/wsr/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 8
[INPUT] num. electrons = 18
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 C     -2.749648430000  -1.202428580000  -0.015740650000 AA   -5.196082471540  -2.272260700550  -0.029745517523 Bohr
[INPUT]  2 H     -2.392994000000  -2.211238580000  -0.015740650000 AA   -4.522103277727  -4.178635312272  -0.029745517523 Bohr
[INPUT]  3 H     -2.392975590000  -0.698030390000  -0.889392160000 AA   -4.522068487869  -1.319086263723  -1.680707599735 Bohr
[INPUT]  4 H     -3.819648430000  -1.202415400000  -0.015740650000 AA   -7.218089424825  -2.272235793959  -0.029745517523 Bohr
[INPUT]  5 C     -2.236306210000  -0.476472310000   1.241664320000 AA   -4.226006267564  -0.900402171839   2.346405503444 Bohr
[INPUT]  6 H     -1.166308020000  -0.478179370000   1.242642670000 AA   -2.204002734684  -0.903628047717   2.348254316998 Bohr
[INPUT]  7 H     -2.591362770000   0.532900710000   1.240686930000 AA   -4.896965924694   1.007036393486   2.344558504027 Bohr
[INPUT]  8 H     -2.594575170000  -0.979740300000   2.115314520000 AA   -4.903036480897  -1.851440840199   3.997365110116 Bohr

nuclear repulsion = 42.6703219875163
number of shells = 40
number of NR pGTOs = 110
number of NR cGTOs = 72
basis = 6-311gss
ecp = {}
CPU time:     12910.77


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/wsr/dftpart/test_hfeda/tmp_ut3g1g_
max_memory 4000 MB (current use 837 MB)
XC functionals = m062x
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2abf1e1291e0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2abf1e129158>
Set gradient conv threshold to 3.16228e-05
tot grids = 87948
init E= -79.8736770447017
  HOMO = -0.433788410776494  LUMO = 0.0296010161195474
cycle= 1 E= -79.7472157175773  delta_E= 0.126  |g|= 0.451  |ddm|= 1.74
  HOMO = -0.320922124635204  LUMO = 0.104744633559735
cycle= 2 E= -79.7591081791513  delta_E= -0.0119  |g|= 0.376  |ddm|= 0.504
  HOMO = -0.411667641343436  LUMO = 0.0852442245841719
cycle= 3 E= -79.7944209347352  delta_E= -0.0353  |g|= 0.0126  |ddm|= 0.231
  HOMO = -0.409834924184163  LUMO = 0.0865241272719486
cycle= 4 E= -79.7944636126112  delta_E= -4.27e-05  |g|= 0.00262  |ddm|= 0.00994
  HOMO = -0.409532107551011  LUMO = 0.086652673813258
cycle= 5 E= -79.794465294417  delta_E= -1.68e-06  |g|= 0.00021  |ddm|= 0.00235
  HOMO = -0.409566867473925  LUMO = 0.0866362663803701
cycle= 6 E= -79.7944653105485  delta_E= -1.61e-08  |g|= 2.32e-05  |ddm|= 0.000321
  HOMO = -0.40956582308044  LUMO = 0.0866377055524693
cycle= 7 E= -79.7944653108441  delta_E= -2.96e-10  |g|= 2.05e-06  |ddm|= 5.02e-05
  HOMO = -0.409566116321684  LUMO = 0.0866375543896592
Extra cycle  E= -79.7944653108456  delta_E= -1.49e-12  |g|= 3.8e-07  |ddm|= 3.39e-06
converged SCF energy = -79.7944653108456
tot grids = 87948
